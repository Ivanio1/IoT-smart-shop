{"ast":null,"code":"export var Html5QrcodeScannerState;\n\n(function (Html5QrcodeScannerState) {\n  Html5QrcodeScannerState[Html5QrcodeScannerState[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  Html5QrcodeScannerState[Html5QrcodeScannerState[\"NOT_STARTED\"] = 1] = \"NOT_STARTED\";\n  Html5QrcodeScannerState[Html5QrcodeScannerState[\"SCANNING\"] = 2] = \"SCANNING\";\n  Html5QrcodeScannerState[Html5QrcodeScannerState[\"PAUSED\"] = 3] = \"PAUSED\";\n})(Html5QrcodeScannerState || (Html5QrcodeScannerState = {}));\n\nvar StateManagerImpl = function () {\n  function StateManagerImpl() {\n    this.state = Html5QrcodeScannerState.NOT_STARTED;\n    this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n  }\n\n  StateManagerImpl.prototype.directTransition = function (newState) {\n    this.failIfTransitionOngoing();\n    this.validateTransition(newState);\n    this.state = newState;\n  };\n\n  StateManagerImpl.prototype.startTransition = function (newState) {\n    this.failIfTransitionOngoing();\n    this.validateTransition(newState);\n    this.onGoingTransactionNewState = newState;\n    return this;\n  };\n\n  StateManagerImpl.prototype.execute = function () {\n    if (this.onGoingTransactionNewState === Html5QrcodeScannerState.UNKNOWN) {\n      throw \"Transaction is already cancelled, cannot execute().\";\n    }\n\n    var tempNewState = this.onGoingTransactionNewState;\n    this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n    this.directTransition(tempNewState);\n  };\n\n  StateManagerImpl.prototype.cancel = function () {\n    if (this.onGoingTransactionNewState === Html5QrcodeScannerState.UNKNOWN) {\n      throw \"Transaction is already cancelled, cannot cancel().\";\n    }\n\n    this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n  };\n\n  StateManagerImpl.prototype.getState = function () {\n    return this.state;\n  };\n\n  StateManagerImpl.prototype.failIfTransitionOngoing = function () {\n    if (this.onGoingTransactionNewState !== Html5QrcodeScannerState.UNKNOWN) {\n      throw \"Cannot transition to a new state, already under transition\";\n    }\n  };\n\n  StateManagerImpl.prototype.validateTransition = function (newState) {\n    switch (this.state) {\n      case Html5QrcodeScannerState.UNKNOWN:\n        throw \"Transition from unknown is not allowed\";\n\n      case Html5QrcodeScannerState.NOT_STARTED:\n        this.failIfNewStateIs(newState, [Html5QrcodeScannerState.PAUSED]);\n        break;\n\n      case Html5QrcodeScannerState.SCANNING:\n        break;\n\n      case Html5QrcodeScannerState.PAUSED:\n        break;\n    }\n  };\n\n  StateManagerImpl.prototype.failIfNewStateIs = function (newState, disallowedStatesToTransition) {\n    for (var _i = 0, disallowedStatesToTransition_1 = disallowedStatesToTransition; _i < disallowedStatesToTransition_1.length; _i++) {\n      var disallowedState = disallowedStatesToTransition_1[_i];\n\n      if (newState === disallowedState) {\n        throw \"Cannot transition from \".concat(this.state, \" to \").concat(newState);\n      }\n    }\n  };\n\n  return StateManagerImpl;\n}();\n\nvar StateManagerProxy = function () {\n  function StateManagerProxy(stateManager) {\n    this.stateManager = stateManager;\n  }\n\n  StateManagerProxy.prototype.startTransition = function (newState) {\n    return this.stateManager.startTransition(newState);\n  };\n\n  StateManagerProxy.prototype.directTransition = function (newState) {\n    this.stateManager.directTransition(newState);\n  };\n\n  StateManagerProxy.prototype.getState = function () {\n    return this.stateManager.getState();\n  };\n\n  StateManagerProxy.prototype.canScanFile = function () {\n    return this.stateManager.getState() === Html5QrcodeScannerState.NOT_STARTED;\n  };\n\n  StateManagerProxy.prototype.isScanning = function () {\n    return this.stateManager.getState() !== Html5QrcodeScannerState.NOT_STARTED;\n  };\n\n  StateManagerProxy.prototype.isStrictlyScanning = function () {\n    return this.stateManager.getState() === Html5QrcodeScannerState.SCANNING;\n  };\n\n  StateManagerProxy.prototype.isPaused = function () {\n    return this.stateManager.getState() === Html5QrcodeScannerState.PAUSED;\n  };\n\n  return StateManagerProxy;\n}();\n\nexport { StateManagerProxy };\n\nvar StateManagerFactory = function () {\n  function StateManagerFactory() {}\n\n  StateManagerFactory.create = function () {\n    return new StateManagerProxy(new StateManagerImpl());\n  };\n\n  return StateManagerFactory;\n}();\n\nexport { StateManagerFactory };","map":{"version":3,"sources":["../../src/state-manager.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["export var Html5QrcodeScannerState;\n(function (Html5QrcodeScannerState) {\n    Html5QrcodeScannerState[Html5QrcodeScannerState[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    Html5QrcodeScannerState[Html5QrcodeScannerState[\"NOT_STARTED\"] = 1] = \"NOT_STARTED\";\n    Html5QrcodeScannerState[Html5QrcodeScannerState[\"SCANNING\"] = 2] = \"SCANNING\";\n    Html5QrcodeScannerState[Html5QrcodeScannerState[\"PAUSED\"] = 3] = \"PAUSED\";\n})(Html5QrcodeScannerState || (Html5QrcodeScannerState = {}));\nvar StateManagerImpl = (function () {\n    function StateManagerImpl() {\n        this.state = Html5QrcodeScannerState.NOT_STARTED;\n        this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n    }\n    StateManagerImpl.prototype.directTransition = function (newState) {\n        this.failIfTransitionOngoing();\n        this.validateTransition(newState);\n        this.state = newState;\n    };\n    StateManagerImpl.prototype.startTransition = function (newState) {\n        this.failIfTransitionOngoing();\n        this.validateTransition(newState);\n        this.onGoingTransactionNewState = newState;\n        return this;\n    };\n    StateManagerImpl.prototype.execute = function () {\n        if (this.onGoingTransactionNewState\n            === Html5QrcodeScannerState.UNKNOWN) {\n            throw \"Transaction is already cancelled, cannot execute().\";\n        }\n        var tempNewState = this.onGoingTransactionNewState;\n        this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n        this.directTransition(tempNewState);\n    };\n    StateManagerImpl.prototype.cancel = function () {\n        if (this.onGoingTransactionNewState\n            === Html5QrcodeScannerState.UNKNOWN) {\n            throw \"Transaction is already cancelled, cannot cancel().\";\n        }\n        this.onGoingTransactionNewState = Html5QrcodeScannerState.UNKNOWN;\n    };\n    StateManagerImpl.prototype.getState = function () {\n        return this.state;\n    };\n    StateManagerImpl.prototype.failIfTransitionOngoing = function () {\n        if (this.onGoingTransactionNewState\n            !== Html5QrcodeScannerState.UNKNOWN) {\n            throw \"Cannot transition to a new state, already under transition\";\n        }\n    };\n    StateManagerImpl.prototype.validateTransition = function (newState) {\n        switch (this.state) {\n            case Html5QrcodeScannerState.UNKNOWN:\n                throw \"Transition from unknown is not allowed\";\n            case Html5QrcodeScannerState.NOT_STARTED:\n                this.failIfNewStateIs(newState, [Html5QrcodeScannerState.PAUSED]);\n                break;\n            case Html5QrcodeScannerState.SCANNING:\n                break;\n            case Html5QrcodeScannerState.PAUSED:\n                break;\n        }\n    };\n    StateManagerImpl.prototype.failIfNewStateIs = function (newState, disallowedStatesToTransition) {\n        for (var _i = 0, disallowedStatesToTransition_1 = disallowedStatesToTransition; _i < disallowedStatesToTransition_1.length; _i++) {\n            var disallowedState = disallowedStatesToTransition_1[_i];\n            if (newState === disallowedState) {\n                throw \"Cannot transition from \".concat(this.state, \" to \").concat(newState);\n            }\n        }\n    };\n    return StateManagerImpl;\n}());\nvar StateManagerProxy = (function () {\n    function StateManagerProxy(stateManager) {\n        this.stateManager = stateManager;\n    }\n    StateManagerProxy.prototype.startTransition = function (newState) {\n        return this.stateManager.startTransition(newState);\n    };\n    StateManagerProxy.prototype.directTransition = function (newState) {\n        this.stateManager.directTransition(newState);\n    };\n    StateManagerProxy.prototype.getState = function () {\n        return this.stateManager.getState();\n    };\n    StateManagerProxy.prototype.canScanFile = function () {\n        return this.stateManager.getState() === Html5QrcodeScannerState.NOT_STARTED;\n    };\n    StateManagerProxy.prototype.isScanning = function () {\n        return this.stateManager.getState() !== Html5QrcodeScannerState.NOT_STARTED;\n    };\n    StateManagerProxy.prototype.isStrictlyScanning = function () {\n        return this.stateManager.getState() === Html5QrcodeScannerState.SCANNING;\n    };\n    StateManagerProxy.prototype.isPaused = function () {\n        return this.stateManager.getState() === Html5QrcodeScannerState.PAUSED;\n    };\n    return StateManagerProxy;\n}());\nexport { StateManagerProxy };\nvar StateManagerFactory = (function () {\n    function StateManagerFactory() {\n    }\n    StateManagerFactory.create = function () {\n        return new StateManagerProxy(new StateManagerImpl());\n    };\n    return StateManagerFactory;\n}());\nexport { StateManagerFactory };\n//# sourceMappingURL=state-manager.js.map"]},"metadata":{},"sourceType":"module"}