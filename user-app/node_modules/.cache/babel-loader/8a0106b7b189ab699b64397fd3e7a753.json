{"ast":null,"code":"var _jsxFileName = \"/Users/isobolev/IdeaProjects/IoT-smart-shop/user-app/src/components/Header.js\";\nimport React, { useState } from \"react\";\nimport { FaShoppingCart } from \"react-icons/fa\";\nimport Order from \"./Order\";\nimport Swal from \"sweetalert2\";\nimport { DEFAULT_URL } from \"../index\";\nwindow.Swal = Swal;\nexport default function Header({\n  orders,\n  onDelete,\n  fullDelete\n}) {\n  let [cartOpen, setCartOpen] = useState(false);\n  let [payment, setPayment] = useState(false);\n  function showOrders(orders) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 14,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 14,\n        columnNumber: 22\n      }\n    }, \"\\u0412\\u0430\\u0448\\u0430 \\u043A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430\"), orders.map(el => /*#__PURE__*/React.createElement(Order, {\n      key: el.id,\n      item: el,\n      onDelete: onDelete,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 15,\n        columnNumber: 17\n      }\n    })), \"                        \", /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 16,\n        columnNumber: 40\n      }\n    }, \"\\u041E\\u0431\\u0449\\u0430\\u044F \\u0441\\u0443\\u043C\\u043C\\u0430 \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430 - \", orders.reduce((acc, el) => acc + el.price, 0), \"\\u20BD\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 18,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      className: \"a\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 19,\n        columnNumber: 21\n      }\n    }, \"\\u041E\\u043F\\u043B\\u0430\\u0442\\u0430:\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"button\",\n      onClick: () => {\n        sendReq('applePay');\n        if (payment == true) {\n          Swal.fire({\n            title: \"Оплата по ApplePay проведена!\",\n            text: \"Спасибо большое за покупку, ждем вас снова!\",\n            icon: \"success\",\n            timer: 2000,\n            showCancelButton: false,\n            showConfirmButton: false\n          });\n          fullDelete();\n          setCartOpen(cartOpen = !cartOpen);\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 20,\n        columnNumber: 21\n      }\n    }, \"ApplePay\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"button\",\n      onClick: async () => {\n        await Swal.fire({\n          title: \"Ожидание оплаты!\",\n          icon: \"info\",\n          html: \"<img src='/sbp.png' style='width:150px; height: 150px' alt=''>\",\n          timer: 7000,\n          showCancelButton: false,\n          showConfirmButton: false\n        });\n        sendReq('sbp');\n        if (payment == true) {\n          Swal.fire({\n            title: \"Оплата по Sbp проведена!\",\n            text: \"Спасибо большое за покупку, ждем вас снова!\",\n            icon: \"success\",\n            timer: 2000,\n            showCancelButton: false,\n            showConfirmButton: false\n          });\n          fullDelete();\n          setCartOpen(cartOpen = !cartOpen);\n        }\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 21\n      }\n    }, \"\\u0421\\u0411\\u041F\")));\n  }\n  function showNothing() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"empty\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }\n    }, \"\\u0422\\u043E\\u0432\\u0430\\u0440\\u043E\\u0432 \\u043D\\u0435\\u0442!\");\n  }\n  function sendReq(Str) {\n    let req = new XMLHttpRequest();\n    req.open(\"POST\", `${DEFAULT_URL}/pay?type=${Str}`, true);\n    req.onload = () => handleResponse(req.responseText);\n    req.onerror = () => alert(\"Сервер временно недоступен\");\n    req.setRequestHeader('Content-Type', 'application/json');\n    req.send(JSON.stringify(orders));\n  }\n  const handleResponse = text => {\n    let response = JSON.parse(text);\n    setPayment(true);\n    if (response.status === 200) {} else {\n      setPayment(false);\n      alert(`Возникла ошибка покупки - ${response.status}! Попробуйте еще раз.`);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"header\", {\n    className: \"head\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }, \"\\u0423\\u043C\\u043D\\u044B\\u0439 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\"), /*#__PURE__*/React.createElement(FaShoppingCart, {\n    onClick: () => setCartOpen(cartOpen = !cartOpen),\n    className: `shop-cart-button ${cartOpen && 'active'}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }\n  }), cartOpen && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"shop-cart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 21\n    }\n  }, orders.length > 0 ? showOrders(orders) : showNothing())));\n}","map":{"version":3,"names":["React","useState","FaShoppingCart","Order","Swal","DEFAULT_URL","window","Header","orders","onDelete","fullDelete","cartOpen","setCartOpen","payment","setPayment","showOrders","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","map","el","key","id","item","reduce","acc","price","className","onClick","sendReq","fire","title","text","icon","timer","showCancelButton","showConfirmButton","html","showNothing","Str","req","XMLHttpRequest","open","onload","handleResponse","responseText","onerror","alert","setRequestHeader","send","JSON","stringify","response","parse","status","length"],"sources":["/Users/isobolev/IdeaProjects/IoT-smart-shop/user-app/src/components/Header.js"],"sourcesContent":["import React, {useState} from \"react\";\nimport {FaShoppingCart} from \"react-icons/fa\";\nimport Order from \"./Order\";\nimport Swal from \"sweetalert2\";\nimport {DEFAULT_URL} from \"../index\";\n\nwindow.Swal = Swal;\n\nexport default function Header({orders, onDelete, fullDelete}) {\n    let [cartOpen, setCartOpen] = useState(false)\n    let [payment, setPayment] = useState(false)\n\n    function showOrders(orders) {\n        return (<div><h2>Ваша корзина</h2>{orders.map(el => (\n                <Order key={el.id} item={el} onDelete={onDelete}/>\n            ))}                        <h2>Общая сумма заказа - {orders.reduce((acc, el) => acc + el.price, 0)}₽</h2>\n\n                <div>\n                    <a className='a'>Оплата:</a>\n                    <button className=\"button\" onClick={() => {\n                        sendReq('applePay')\n                        if (payment == true) {\n                            Swal.fire({\n                                title: \"Оплата по ApplePay проведена!\",\n                                text: \"Спасибо большое за покупку, ждем вас снова!\",\n                                icon: \"success\",\n                                timer: 2000,\n                                showCancelButton: false,\n                                showConfirmButton: false\n                            })\n                            fullDelete()\n                            setCartOpen(cartOpen = !cartOpen)\n                        }\n\n                    }\n\n                    }>ApplePay\n                    </button>\n                    <button className=\"button\" onClick={async () => {\n\n                        await Swal.fire({\n                            title: \"Ожидание оплаты!\",\n                            icon: \"info\",\n                            html: \"<img src='/sbp.png' style='width:150px; height: 150px' alt=''>\",\n                            timer: 7000,\n                            showCancelButton: false,\n                            showConfirmButton: false\n                        })\n\n\n                        sendReq('sbp')\n                        if (payment == true) {\n                            Swal.fire({\n                                title: \"Оплата по Sbp проведена!\",\n                                text: \"Спасибо большое за покупку, ждем вас снова!\",\n                                icon: \"success\",\n                                timer: 2000,\n                                showCancelButton: false,\n                                showConfirmButton: false\n                            })\n                            fullDelete()\n                            setCartOpen(cartOpen = !cartOpen)\n                        }\n                    }\n                    }>СБП\n                    </button>\n                </div>\n            </div>\n\n        )\n    }\n\n    function showNothing() {\n        return (<div className='empty'>\n            Товаров нет!\n        </div>);\n    }\n\n    function sendReq(Str) {\n        let req = new XMLHttpRequest();\n        req.open(\"POST\", `${DEFAULT_URL}/pay?type=${Str}`, true);\n        req.onload = () => handleResponse(req.responseText);\n        req.onerror = () => alert(\"Сервер временно недоступен\");\n        req.setRequestHeader('Content-Type', 'application/json');\n        req.send(JSON.stringify(orders));\n\n    }\n\n    const handleResponse = (text) => {\n            let response = JSON.parse(text);\n            setPayment(true)\n            if (response.status === 200) {\n            } else {\n                setPayment(false)\n                alert(`Возникла ошибка покупки - ${response.status}! Попробуйте еще раз.`);\n            }\n        }\n    ;\n\n    return (\n        <header className=\"head\">\n            <div>\n\n                <span className=\"logo\">Умный магазин</span>\n\n                <FaShoppingCart onClick={() => setCartOpen(cartOpen = !cartOpen)}\n                                className={`shop-cart-button ${cartOpen && 'active'}`}/>\n                {cartOpen && (\n                    <div className='shop-cart'>\n\n                        {\n                            orders.length > 0 ? showOrders(orders) : showNothing()\n                        }\n                    </div>\n\n                )}\n            </div>\n        </header>)\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}